"use strict";(()=>{var e={};e.id=303,e.ids=[303],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},6162:e=>{e.exports=require("stream")},1764:e=>{e.exports=require("util")},4812:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>y,requestAsyncStorage:()=>c,routeModule:()=>l,serverHooks:()=>x,staticGenerationAsyncStorage:()=>m});var s={};r.r(s),r.d(s,{POST:()=>d});var n=r(9303),a=r(8716),i=r(670),o=r(7070),p=r(728),u=r(5456);async function d(e){try{let t=(0,u.v6)(e);if(!t)return o.NextResponse.json({error:"unauthorized"},{status:401});let{displayName:r}=await e.json();if(!r||"string"!=typeof r)return o.NextResponse.json({error:"displayName is required"},{status:400});let s=await p._.profile.findUnique({where:{userId:t.userId}});if(!s)return o.NextResponse.json({error:"profile not found"},{status:404});if(s.nicknameUpdatedAt){let e=new Date(s.nicknameUpdatedAt.getTime()+6048e5);if(new Date<e)return o.NextResponse.json({success:!1,nextChangeAt:e},{status:200})}return await p._.profile.update({where:{userId:t.userId},data:{nickname:r,nicknameUpdatedAt:new Date,updatedAt:new Date}}),o.NextResponse.json({success:!0})}catch(e){return console.error("display-name error",e),o.NextResponse.json({error:"failed to update display name"},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/profile/display-name/route",pathname:"/api/profile/display-name",filename:"route",bundlePath:"app/api/profile/display-name/route"},resolvedPagePath:"C:\\Users\\user\\Documents\\coding\\userhythm\\backend\\src\\app\\api\\profile\\display-name\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:c,staticGenerationAsyncStorage:m,serverHooks:x}=l,f="/api/profile/display-name/route";function y(){return(0,i.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:m})}},5456:(e,t,r)=>{r.d(t,{B3:()=>p,Rf:()=>d,Uj:()=>u,v6:()=>l});var s=r(1482),n=r.n(s),a=r(1615);let i="ur_session",o=process.env.SESSION_SECRET||"dev-secret-change-me",p=e=>n().sign(e,o,{expiresIn:604800}),u=e=>{(0,a.cookies)().set(i,e,{httpOnly:!0,sameSite:"strict",secure:!0,path:"/",maxAge:604800})},d=()=>{(0,a.cookies)().set(i,"",{httpOnly:!0,sameSite:"strict",secure:!0,path:"/",maxAge:0})},l=e=>{let t=e.cookies.get(i)?.value;if(!t)return null;try{return n().verify(t,o)}catch{return null}}},728:(e,t,r)=>{r.d(t,{_:()=>n});let s=require("@prisma/client"),n=global.prisma||new s.PrismaClient({})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,972,261],()=>r(4812));module.exports=s})();