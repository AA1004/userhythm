# -*- coding: utf-8 -*-
"""
Game.tsx 파일의 깨진 한글을 수정하는 스크립트
"""
import re

file_path = r'C:\Users\user\Documents\coding\userythm\src\components\Game.tsx'

# 깨진 한글 패턴과 올바른 한글 매핑
fixes = [
    # 키 관련
    (r'// \?\?\?\?림 \?\?태 \?\?데\?\?트 - \?\?\?\?\?\?만 \?\?깐 \?\?\?\?으\?\?변\?\?\?', 
     '// 키 프레스 상태 업데이트 - 키를 눌렀을 때만 눌린 상태로 변경'),
    (r'// \?\?\? \?\?린 \?\?는 \?\?데\?\?트 \?\?략', 
     '// 이미 누른 키는 업데이트 스킵'),
    (r'// \?\?\? \?\?\?\?\?\?만 짧\? \?\?간 \?\?\?\?\?\?으\?\?\?\?아\?\?', 
     '// 키를 뗄 때만 짧게 시간 동안 떼어놓음'),
    (r'// 100ms \?\?\?\?\?\?으\?\?\?\?아\?\?', 
     '// 100ms 후에 키 떼기'),
    
    # 노트 관련
    (r'// \?\?당 \?\?인\?\?\?가\?\?\?가까운 \?\?트 찾기', 
     '// 해당 레인에서 가장 가까운 노트 찾기'),
    (r'// \?\?트가 \?\?으\?\?\?\?무것도 \?\?\?\? \?\?음 \(\?\?공\?\?\?\?\?\?르\?\?\?\?\?\?처리 \?\?\?\?\?\?', 
     '// 노트가 없으면 아무것도 하지 않음 (성공/실패 판단을 처리 안 함)'),
    (r'// \?\?드\?\?\?\?거\?\? \?\?펙\?\?\?\?거\?\?requestAnimationFrame\?\?로 처리\?\?여 \?\?더\?\?\?\?최적\?\?\?\?', 
     '// 피드백 제거와 이펙트 제거를 requestAnimationFrame으로 처리하여 렌더링 최적화'),
    
    # Miss 처리 관련
    (r'// \?\?\?\?경우\?\?도 Miss 처리\?\?\?\? \?\?음 \(\?\?공\?\?\?\?\?\?르\?\?\?\?\?\?건이 \?\?니지\?\?처리 \?\?\?\?\?\?', 
     '// 이 경우에도 Miss 처리를 하지 않음 (성공/실패가 구별이 안 되면 처리 안 함)'),
    (r'// \?\?존\?\?\?\?\?\?거\?\?여 \?\?수 \?\?생\?\?\?\?방\?\?', 
     '// 기존 코드 제거하여 함수 생성을 방지'),
    (r'// \?\?\?\? 처리\?\?\?\?\?\?트\?\?\?\?\?\?시 처리\?\?\?\?\?\? \?\?음', 
     '// 이미 처리된 노트는 다시 처리하지 않음'),
    (r"console\.log\('\?\?\?\? 처리\?\?\?\?\?\?트:', note\.id\);", 
     "console.log('이미 처리된 노트:', note.id);"),
    (r'// 처리\?\?\?\?\?\?트 ID 기록', 
     '// 처리된 노트 ID 기록'),
    
    # YouTube 관련
    (r"console\.warn\('YouTube \?\?시\?\?\?\?\?\? \?\?패:', e\);", 
     "console.warn('YouTube 일시정지 실패:', e);"),
    (r"console\.warn\('YouTube \?\?생 \?\?패:', e\);", 
     "console.warn('YouTube 재생 실패:', e);"),
    (r'console\.error\('YouTube IFrame API\?\?로드\?\?\?\?\?\?습\?\?\?\?\?\?다\.\'\)', 
     "console.error('YouTube IFrame API를 로드하지 못했습니다.');"),
    (r"console\.warn\('\?\?스\?\?\?\?\?\?레\?\?\?\?\?\?어 \?\?거 \?\?패:', e\);", 
     "console.warn('테스트 플레이어 생성 실패:', e);"),
    (r"console\.warn\('\?\?스\?\?\?\?\?\?레\?\?\?\?\?\?어 \?\?리 \?\?패:', e\);", 
     "console.warn('테스트 플레이어 정리 실패:', e);"),
    (r"console\.log\('\?\?\?\?스\?\?\?\?\?\?YouTube \?\?레\?\?\?\?\?\?어 준\?\?\?\?\?\?료'\);", 
     "console.log('✅ 테스트 YouTube 플레이어 준비 완료');"),
    (r"console\.error\('\?\?스\?\?\?\?\?\?레\?\?\?\?\?\?어 \?\?성 \?\?패:', e\);", 
     "console.error('테스트 플레이어 생성 실패:', e);"),
    
    # UI 관련
    (r'\?\?트 \?\?도:', 
     '노트 속도:'),
    (r'// \?\?차가 0\.3\?\?\?\?상\?\?\?\?만 \?\?기\?\?\?\?', 
     '// 차이가 0.3초 이상일 때만 시키기'),
    (r"console\.warn\('YouTube \?\?간 \?\?기\?\?\?\?\?\?패:', e\);", 
     "console.warn('YouTube 시간 시키기 실패:', e);"),
    (r'// \?\?생 \?\?태 \?\?인', 
     '// 재생 상태 확인'),
    (r'alert\('\?\?택\?\?\?\?\?\?작 \?\?치 \?\?후\?\?\?\?\?\?트가 \?\?습\?\?\?\?\?\?다\. \?\?작 \?\?치\?\?조정\?\?주\?\?\?\?요\.\'\);', 
     "alert('선택한 시작 위치 이후에 노트가 없습니다. 시작 위치를 조정해주세요.');"),
    
    # 기타
    (r'// YouTube \?\?디\?\?\?\?\?\?정 \?\?\?\?\?\?', 
     '// YouTube 오디오 설정 전달'),
    (r'// YouTube \?\?레\?\?\?\?\?\?어 \?\?리', 
     '// YouTube 플레이어 정리'),
    (r'// \?\?스\?\?\?\?\?\?모드 YouTube \?\?레\?\?\?\?\?\?어 초기\?\?\?\?\?\?', 
     '// 테스트 모드 YouTube 플레이어 초기화'),
    (r'// 기존 \?\?레\?\?\?\?\?\?어 \?\?리', 
     '// 기존 플레이어 정리'),
    (r'// \?\?스\?\?\?\?\?\?모드 YouTube \?\?디\?\?\?\?\?\?\?\?기\?\?\?\?\?\?', 
     '// 테스트 모드 YouTube 오디오 동기화'),
]

def fix_file():
    with open(file_path, 'r', encoding='utf-8', errors='replace') as f:
        content = f.read()
    
    original_content = content
    
    # 각 패턴을 수정
    for pattern, replacement in fixes:
        content = re.sub(pattern, replacement, content)
    
    # 추가로 직접 찾아서 바꾸기
    replacements = {
        '게임 시작/종료 UI': '게임 시작/종료 UI',
        '첫 화면 표시': '첫 화면 표시',
        '설정': '설정',
        '게임 설정': '게임 설정',
    }
    
    # 파일이 변경되었는지 확인
    if content != original_content:
        with open(file_path, 'w', encoding='utf-8') as f:
            f.write(content)
        print('파일이 수정되었습니다.')
    else:
        print('수정할 내용이 없습니다.')

if __name__ == '__main__':
    fix_file()

